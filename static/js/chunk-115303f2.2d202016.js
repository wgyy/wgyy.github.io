(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-115303f2"],{"0607":function(t,e,i){},"0bd4":function(t,e,i){},1261:function(t,e,i){},"1e4b":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-editor-container"},[i("div",{staticClass:"drag-container"},[i("type-list",{on:{addNode:t.addNode}})],1),i("div",{ref:"otherContainer",staticClass:"other"},[i("ScreenEditor",{ref:"formContainer",style:t.formEditor.parent.attrs.style,attrs:{"is-parent":t.isParent,parent:t.formEditor.parent,"form-editor":t.formEditor.children,"target-id":t.editTarget.uuid},on:{click:t.handleClick,editScreen:t.handleEditScreen}})],1),i("el-card",{staticClass:"setting",style:{width:t.isExpand?"450px":"0px",padding:t.isExpand?"20px":"0px"}},[i("el-button",{staticClass:"right-side-btn",attrs:{type:"primary",icon:t.isExpand?"el-icon-caret-right":"el-icon-caret-left"},on:{click:function(e){t.isExpand=!t.isExpand}}}),i("AttrEditor",{directives:[{name:"show",rawName:"v-show",value:t.isExpand,expression:"isExpand"}],attrs:{"edit-target":t.editTarget},on:{save:t.handleSave}})],1),i("div",{staticStyle:{position:"absolute",bottom:"0px",left:"0",color:"red"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.handlePost}},[t._v("预览")])],1)],1)},r=[],a=i("5530"),s=(i("159b"),i("b680"),i("7db0"),i("c740"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("2ef0")),o=i.n(s),d=i("21bf"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"formContainer",staticClass:"form-container"},[i("div",{staticClass:"screen-btn"},[i("el-button",{attrs:{type:"text"},on:{click:t.hanleEditScreen}},[t._v("编辑大屏")])],1),i("DraggableResiable",{attrs:{"is-parent":t.isParent,parent:t.parent,"target-id":t.targetId,"form-editor":t.formEditor},on:{click:t.handleClick,openContextMenu:t.handleOpeContenxtMenu}}),i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClickOutside,expression:"handleClickOutside"}],ref:"pop",staticClass:"pop"},[i("ul",[i("li",[i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleDelete()}}},[t._v("删除按钮")])],1),i("li",[i("el-button",{attrs:{type:"text"}},[t._v("文字按钮")])],1),i("li",[i("el-button",{attrs:{type:"text"}},[t._v("文字按钮")])],1),i("li",[i("el-button",{attrs:{type:"text"}},[t._v("文字按钮")])],1)]),i("div",{attrs:{id:"arrow","data-popper-arrow":""}})])],1)},h=[],l=(i("a9e3"),i("a434"),i("39c3")),u=i("9169"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._l(t.formEditor,(function(e){return i("vue-draggable-resizable",{key:e.uuid,ref:"deaggable",refInFor:!0,attrs:{x:e.x,y:e.y,w:e.width,h:e.height,parent:!1,"on-drag-start":t.handleDragStart,"on-drag":t.handleOnDrag,"on-resize-start":t.handleOnResizeStart,"on-resize":t.handleOnResize,uuid:e.uuid},on:{resizestop:t.handleStop,dragstop:t.handleStop}},[i("div",{staticClass:"chart",class:{current:t.targetId===e.uuid},attrs:{uuid:e.uuid},on:{contextmenu:function(i){return i.preventDefault(),function(i){return t.handleOpeContenxtMenu(i,e.uuid)}(i)},click:function(i){return t.handleClick(e.uuid)}}},[i("ComponentRender",{attrs:{element:e}})],1)])})),i("support-lines",{attrs:{lines:t.allLines,matched:t.matched}})],2)},p=[],g=(i("d81d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._l(t.lines[0],(function(e,n){return i("div",{key:"hor-"+n+"-group",staticClass:"horLine"},t._l(e.arr,(function(n,r){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.matched.y.id===e.id&&t.matched.y.index===r,expression:"matched.y.id===horLines.id&& matched.y.index === index2"}],key:"hor-"+r,style:{top:n+"px"}})})),0)})),t._l(t.lines[1],(function(e,n){return i("div",{key:"ver-"+n+"-group",staticClass:"verLine"},t._l(e.arr,(function(n,r){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.matched.x.id===e.id&&t.matched.x.index===r,expression:"matched.x.id===verLines.id&& matched.x.index === index2"}],key:"ver-"+r,style:{left:n+"px"}})})),0)}))],2)}),m=[],x={props:{lines:{type:Array,default:function(){return[[],[]]}},matched:{type:Object,default:function(){return{x:{id:"",index:""},y:{id:"",index:""}}}}}},y=x,b=(i("4d91"),i("2877")),v=Object(b["a"])(y,g,m,!1,null,"1a8d6e24",null),C=v.exports,E=i("cdbb"),w=i("f13d"),k=(i("278f"),{components:{SupportLines:C,ComponentRender:E["a"],VueDraggableResizable:w["a"]},props:{formEditor:{type:Array,default:function(){return[]}},targetId:{type:[String,Number],default:""},parent:{type:Object,default:function(){}}},data:function(){return{target:null,matched:{x:{id:"",index:""},y:{id:"",index:""}}}},computed:{spacing:function(){var t,e;return(null===(t=this.parent)||void 0===t||null===(e=t.props)||void 0===e?void 0:e.spacing)||10},allLines:function(){var t=this.formEditor.map((function(t){return[{id:t.uuid,arr:[t.y,(2*t.y+t.height)/2,t.y+t.height]},{id:t.uuid,arr:[t.x,(2*t.x+t.width)/2,t.x+t.width]}]}));return t.push([{id:0,arr:[this.parent.height/2]},{id:0,arr:[this.parent.width/2]}]),t.reduce((function(t,e){return t[0].push(e[0]),t[1].push(e[1]),t}),[[],[]])}},methods:{handleClick:function(t){this.$emit("click",t)},handleDragStart:function(t){var e=t.target.attributes.uuid.nodeValue;this.target=this.formEditor.find((function(t){return t.uuid===e}))},calcePosition:function(t,e){for(var i,n=!1,r=this.allLines[0],a=this.allLines[1],s=0;s<a.length;s++)if(this.target.uuid!==a[s].id){if(Math.abs(a[s].arr[0]-t)<this.spacing){this.target.x=a[s].arr[0],i=!0,this.matched.x.id=a[s].id,this.matched.x.index=0;break}if(Math.abs(a[s].arr[1]-(2*t+this.target.width)/2)<this.spacing){this.target.x=(2*a[s].arr[1]-this.target.width)/2,this.matched.x.id=a[s].id,this.matched.x.index=1,i=!0;break}if(Math.abs(a[s].arr[2]-t)<this.spacing){this.target.x=a[s].arr[2],i=!0,this.matched.x.id=a[s].id,this.matched.x.index=2;break}if(Math.abs(a[s].arr[0]-(t+this.target.width))<=this.spacing){this.target.x=a[s].arr[0]-this.target.width,this.matched.x.id=a[s].id,this.matched.x.index=0,i=!0;break}if(Math.abs(a[s].arr[2]-(t+this.target.width))<=this.spacing){this.target.x=a[s].arr[2]-this.target.width,this.matched.x.id=a[s].id,this.matched.x.index=2,i=!0;break}if(Math.abs(this.parent.width/2-(2*t+this.target.width)/2)<=this.spacing){this.target.x=(this.parent.width-this.target.width)/2,this.matched.x.id=0,this.matched.x.index=0,i=!0;break}}for(var o=0;o<r.length;o++)if(this.target.uuid!==r[o].id){if(Math.abs(r[o].arr[0]-e)<=this.spacing){this.target.y=r[o].arr[0],n=!0,this.matched.y.id=r[o].id,this.matched.y.index=0;break}if(Math.abs(r[o].arr[1]-(2*e+this.target.height)/2)<this.spacing){this.target.y=(2*r[o].arr[1]-this.target.height)/2,this.matched.y.id=r[o].id,this.matched.y.index=1,n=!0;break}if(Math.abs(r[o].arr[2]-e)<=this.spacing){this.target.y=r[o].arr[2],this.matched.y.id=r[o].id,this.matched.y.index=2,n=!0;break}if(Math.abs(r[o].arr[0]-(e+this.target.height))<=this.spacing){this.target.y=r[o].arr[0]-this.target.height,this.matched.y.id=r[o].id,this.matched.y.index=0,n=!0;break}if(Math.abs(r[o].arr[2]-(e+this.target.height))<=this.spacing){this.target.y=r[o].arr[2]-this.target.height,this.matched.y.id=r[o].id,this.matched.y.index=2,n=!0;break}if(Math.abs(this.parent.height/2-(2*e+this.target.height)/2)<=this.spacing){this.target.y=(this.parent.height-this.target.height)/2,this.matched.y.id=0,this.matched.y.index=0,n=!0;break}}i||(this.target.x=Math.floor(t),this.matched.x.id="",this.matched.x.index=""),n||(this.target.y=Math.floor(e),this.matched.y.id="",this.matched.y.index="")},handleOnDrag:function(t,e){var i=this;this.calcePosition(t,e),this.$refs.deaggable.forEach((function(t){t.$attrs.uuid===i.target.uuid&&i.$nextTick((function(){t.left=i.target.x,t.top=i.target.y}))}))},handleOnResizeStart:function(t,e){var i=e.path.find((function(t){return t.className.indexOf("active")>-1})).attributes.uuid.nodeValue;this.target=this.formEditor.find((function(t){return t.uuid===i}))},handleOnResize:function(t,e,i,n,r){this.target.x=e,this.target.y=i,this.target.width=n,this.target.height=r},handleOpeContenxtMenu:function(t,e){this.$emit("openContextMenu",t,e)},handleStop:function(){this.target=null,this.matched={x:{id:"",index:""},y:{id:"",index:""}}}}}),O=k,S=(i("e68f"),Object(b["a"])(O,f,p,!1,null,"6b9fa425",null)),$=S.exports,_={directives:{Clickoutside:u["a"]},components:{DraggableResiable:$},props:{formEditor:{type:Array,default:function(){return[]}},targetId:{type:[String,Number],default:""},parent:{type:Object,default:function(){}},isParent:{type:Boolean,default:function(){return!0}}},data:function(){return{virtualElement:{getBoundingClientRect:this.generateGetBoundingClientRect()},instance:null}},mounted:function(){this.instance=Object(l["a"])(this.virtualElement,this.$refs.pop,{placement:"right-start",modifiers:[{name:"offset",options:{offset:[0,20]}}]})},methods:{handleClick:function(t){this.$emit("click",t)},hanleEditScreen:function(){this.$emit("editScreen")},handleOpeContenxtMenu:function(t,e){this.virtualElement.getBoundingClientRect=this.generateGetBoundingClientRect(t.clientX,t.clientY),this.instance.update(),this.$refs.pop.setAttribute("data-show",""),this.$emit("click",e)},handleClickOutside:function(){this.$refs.pop.removeAttribute("data-show")},handleDelete:function(t){var e=this,i=this.formEditor.findIndex((function(t){return e.targetId===t.uuid}));this.formEditor.splice(i,1),this.$emit("click"),this.handleClickOutside()},generateGetBoundingClientRect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){return{width:0,height:0,top:e,right:t,bottom:e,left:t}}}}},M=_,j=(i("a33d"),Object(b["a"])(M,c,h,!1,null,"ef9473b0",null)),R=j.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",t._l(t.types,(function(e){return i("li",{key:e.type},[i("el-popover",{attrs:{placement:"right",trigger:"click",offset:30}},[i("ComponentDragger",t._g({attrs:{list:e.children}},t.$listeners)),i("div",{attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"icon",class:e.icon}),i("div",[t._v(t._s(e.title))]),i("i",{staticClass:"el-icon-caret-right"})])],1)],1)})),0)])},D=[],z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"component-container"},t._l(t.list,(function(e,n){return i("draggable",{key:n,attrs:{options:t.draggableOptions},on:{end:t.end,start:t.move}},[i("DraggerItem",{attrs:{element:e}})],1)})),1)},N=[],A=i("b76a"),L=i.n(A);i("a15b");function I(){for(var t=[],e="0123456789abcdef",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n}var F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"drag-item",attrs:{type:t.element.type}},[i("el-card",{attrs:{shadow:"hover"}},[i("div",{staticClass:"content"},[i("img",{attrs:{src:t.element.img}}),i("span",[t._v(t._s(t.element.name))])])])],1)},B=[],P={props:{element:{type:Object,default:function(){}}},data:function(){return{}},computed:{}},H=P,W=(i("d1f4"),Object(b["a"])(H,F,B,!1,null,"4942844c",null)),J=W.exports,V={components:{draggable:L.a,DraggerItem:J},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{dragComponent:null,draggableOptions:{preventOnFilter:!1,sort:!1,disabled:!1,forceFallback:!0},offset:{x:0,y:0}}},methods:{move:function(t){var e=t.item.attributes.type.nodeValue,i=this.list.find((function(t){return t.type===e})),n=t.item.getBoundingClientRect();this.offset.x=t.originalEvent.clientX-n.x,this.offset.y=t.originalEvent.clientY-n.y,this.dragComponent=JSON.parse(JSON.stringify(i)),this.$set(this.dragComponent,"uuid",I())},end:function(t){this.$emit("addNode",t,this.dragComponent,this.offset),this.dragComponent=null}}},G=V,X=(i("33d4"),Object(b["a"])(G,z,N,!1,null,"260cc7ae",null)),Y=X.exports,U=i("6b62"),K=i.n(U),q=i("73b0"),Q=i.n(q),Z=i("2dff"),tt=i.n(Z),et=i("78a2"),it=i.n(et),nt=i("aeb4"),rt=i.n(nt),at=i("0930"),st=[{type:"chart",icon:"el-icon-pie-chart",title:"图表",children:[{name:"折线图",type:"line",img:Q.a,component:at["a"],attrs:{style:{}},props:{options:{xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[150,230,224,218,135,147,260],type:"line"}]}},dataSource:{url:"",method:"",params:{}}},{name:"柱状图",type:"bar",img:K.a,component:at["a"],attrs:{style:{}},props:{options:{xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[120,200,150,80,70,110,130],type:"bar"}]}},dataSource:{url:"",method:"",params:{}}},{name:"地图",type:"map",img:tt.a,component:at["a"],attrs:{style:{}},props:{options:{}},dataSource:{url:"",method:"",params:{}}}]},{type:"other",icon:"el-icon-more-outline",title:"其他",children:[{name:"文本",type:"text",img:it.a,component:at["c"],attrs:{style:{fontSize:"14px",lineHeight:"20px",color:"#ccc"}},props:{title:"文本内容"}},{name:"图片",type:"image",img:rt.a,component:at["b"],attrs:{style:{}},props:{src:rt.a,fit:""}}]}],ot={components:{ComponentDragger:Y},data:function(){return{types:st}}},dt=ot,ct=(i("be27"),Object(b["a"])(dt,T,D,!1,null,"82b10f9a",null)),ht=ct.exports,lt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(t.component,{tag:"component",attrs:{"edit-target":t.editTarget},on:{save:t.handleSave}})},ut=[],ft={props:{editTarget:{type:Object,default:function(){}}},computed:{component:function(){switch(this.editTarget.component){case at["a"]:return"ChartEditor";case at["c"]:return"TextEditor";case at["b"]:return"ImageEditor";case"Screen":return"ScreenContainerEditor";default:return null}}},methods:{handleSave:function(t){this.$emit("save",t)}}},pt=ft,gt=Object(b["a"])(pt,lt,ut,!1,null,"e1f213dc",null),mt=gt.exports,xt=i("f325"),yt=(i("bc3a"),{components:{ScreenEditor:R,TypeList:ht,AttrEditor:mt},data:function(){return{isExpand:!0,isParent:!0,displayOptions:{animation:200},formEditor:{parent:{width:0,height:0,attrs:{style:{}},props:{spacing:10},component:"Screen"},children:[]},json:null,editTarget:{}}},mounted:function(){var t=this,e=this.$refs.formContainer.$el;this.$nextTick((function(){t.formEditor.parent.width=e.clientWidth,t.formEditor.parent.height=e.clientHeight,t.initDataCanvas(),t.initChartsContainer()})),Object(d["a"])(this.$refs.otherContainer,this.handleResize)},beforeDestroy:function(){Object(d["b"])(this.$refs.otherContainer,this.handleResize)},methods:{initDataCanvas:function(){this.json&&(this.formEditor=xt)},handleResize:o.a.debounce((function(){console.log("resize"),this.initChartsContainer()}),500),addNode:function(t,e,i){var n=this.$refs.formContainer.$el;t.originalEvent.path.some((function(t){return t===n}))?this.formEditor.children.push(Object(a["a"])(Object(a["a"])({},e),{},{x:t.originalEvent.layerX-i.x,y:t.originalEvent.layerY-i.y,width:t.item.clientWidth,height:t.item.clientHeight})):this.$message.error("请把节点拖入到表单编辑框中")},initChartsContainer:function(){var t=this,e=this.$refs.otherContainer,i=this.$refs.formContainer.$el,n=16/9,r=e.clientWidth,a=e.clientHeight;r/a>n?(i.style.width=a*n+"px",i.style.height=a+"px"):(i.style.width=r+"px",i.style.height=r/n+"px");var s=i.clientWidth/this.formEditor.parent.width,o=i.clientHeight/this.formEditor.parent.height;this.formEditor.children.forEach((function(t){t.width=+(t.width*s).toFixed(0),t.height=+(t.height*o).toFixed(0),t.x=+(t.x*s).toFixed(0),t.y=+(t.y*o).toFixed(0)})),this.$nextTick((function(){t.formEditor.parent.width=i.clientWidth,t.formEditor.parent.height=i.clientHeight}))},handleClick:function(t){this.editTarget=t?this.formEditor.children.find((function(e){return e.uuid===t})):{}},handleEditScreen:function(){this.editTarget=this.formEditor.parent},handleSave:function(t){if("Screen"===t.component)this.formEditor.parent=t,this.editTarget=t;else{var e=this.formEditor.children.findIndex((function(e){return e.uuid===t.uuid}));this.$set(this.formEditor.children,e,t),this.editTarget=t}},handlePost:function(){var t=new Blob([JSON.stringify(this.formEditor)]),e=URL.createObjectURL(t);window.open("/#/show?url="+e)}}}),bt=yt,vt=(i("20cf"),Object(b["a"])(bt,n,r,!1,null,"d82e1a2a",null));e["default"]=vt.exports},"20cf":function(t,e,i){"use strict";i("a1ff")},"2dff":function(t,e,i){t.exports=i.p+"static/img/map-HK.56750461.png"},"33d4":function(t,e,i){"use strict";i("a12b")},"4d91":function(t,e,i){"use strict";i("f051")},"6b62":function(t,e,i){t.exports=i.p+"static/img/bar-simple.c37d422f.png"},"73b0":function(t,e,i){t.exports=i.p+"static/img/line-simple.340e1944.png"},"78a2":function(t,e,i){t.exports=i.p+"static/img/text.13412bae.png"},a12b:function(t,e,i){},a1ff:function(t,e,i){},a33d:function(t,e,i){"use strict";i("0607")},aeb4:function(t,e,i){t.exports=i.p+"static/img/image.3f632678.png"},be27:function(t,e,i){"use strict";i("1261")},d12d:function(t,e,i){},d1f4:function(t,e,i){"use strict";i("0bd4")},e68f:function(t,e,i){"use strict";i("d12d")},f051:function(t,e,i){}}]);